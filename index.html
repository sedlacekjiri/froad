<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <title>Froad Community + Live Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="explore.css" />
</head>
<body>
  <header>
    <img class="logo-header" src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68ea50150761950e794dd2bb_logo-black.png" alt="Logo" />
    <div class="header-right">
      <span id="headerName" class="header-name"></span>
      <img id="profileIcon" class="profile-icon fallback" src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68e956576523671093377344_account.png" alt="Profile" />
    </div>
  </header>

  <div id="mapContainer"><div id="map"></div></div>

  <!-- User detail slide-up panel -->
<div id="userDetailPanel">
  <div id="userDetailContent">

    <div class="user-section">
      <h3>Bio</h3>
      <p id="userBioText">Loading...</p>
    </div>

    <div class="user-section">
      <h3>Vehicle</h3>
      <p id="userVehicleText">Loading...</p>
    </div>

    <div class="user-section">
      <h3>Vehicle photo</h3>
      <div id="userVehiclePhotoWrapper">
        <img id="userVehiclePhoto" src="" alt="Vehicle photo" />
      </div>
    </div>

  </div>
</div>

<div id="globalLoader">
  <img src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68ea50150761950e794dd2bb_logo-black.png" alt="Logo" class="loader-logo"/>
  <div class="loader-spinner"></div>
</div>



  <!-- Floating Share Location Button -->
<button id="shareLocationBtn" class="share-location-btn">
  <img src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68ed62ac5fa9fb8e0fe1bf96_live.png" alt="Live Icon" class="live-icon" />
  Share Location
</button>

<!-- Visibility Toggle Button -->
<button id="visibilityBtn" class="share-location-btn visibility-btn">
  <img id="visibilityIcon"
       src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68f6a54a2914de7af9a65d54_blind.png"
       alt="Visibility Toggle"
       class="live-icon" />
</button>

<!-- Satellite Toggle Button -->
<button id="customActionBtn" class="visibility-btn">
  <img
    id="customActionIcon"
    src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68f6ca8e8bd3492108cb48c8_layers.png"
    alt="Toggle Satellite"
  />
</button>


<div id="exploreMap" style="display:none;">
  <!-- Vehicle filter -->
  <div id="vehicleFilter" style="position:absolute;top:10px;left:60px;z-index:1000;
       background:white;padding:10px 14px;border-radius:8px;
       box-shadow:0 2px 5px rgba(0,0,0,.2);display:flex;align-items:center;gap:10px;">
    <img src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/6893c2dc9f3ada3f8c6f8a16_jeeps.png"
         alt="Jeep icon" style="width:24px; height:auto;" />
    <select id="vehicleSelect" style="font-size:14px; padding:4px 8px; border-radius:4px;">
      <option value="all">Choose your 4x4 vehicle</option>
  
  <!-- Compact SUVs -->
  <option value="jimny">Suzuki Jimny</option>
  <option value="duster">Dacia Duster</option>
  <option value="sportage">Kia Sportage</option>
  <option value="tucson">Hyundai Tucson</option>
  <option value="rav4">Toyota RAV4</option>

  <!-- Mid-size SUVs -->
  <option value="outlander">Mitsubishi Outlander</option>
  <option value="xtrail">Nissan X-Trail</option>
  <option value="forester">Subaru Forester</option>
  <option value="cx5">Mazda CX-5</option>

  <!-- Large SUVs & Offroad -->
  <option value="landcruiser">Toyota Land Cruiser</option>
  <option value="hilux">Toyota Hilux</option>
  <option value="wrangler">Jeep Wrangler</option>
  <option value="renegade">Jeep Renegade</option>
  <option value="defender">Land Rover Defender</option>
  <option value="discovery">Land Rover Discovery</option>
  <option value="grenadier">INEOS Grenadier</option>

  <!-- Luxury -->
  <option value="xc90">Volvo XC90</option>
  <option value="x5">BMW X5</option>
  <option value="gle">Mercedes GLE</option>
  <option value="gclass">Mercedes G-Class</option>
  <option value="q7">Audi Q7</option>

  <!-- Campers -->
  <option value="transporter-4x4">VW Transporter 4x4 Camper</option>
  <option value="sprinter-4x4">Mercedes Sprinter 4x4 Camper</option>
</select>

  </div>

<!-- Bottom-left info box (subtle) -->
<div id="bottomInfoBox">
  <div id="currentTime"></div>
  <button id="openDisclaimer" type="button" title="Important Disclaimer">Safety notice</button>
</div>

<!-- Backdrop + Modal (white theme) -->
<div id="legalModalBackdrop" aria-hidden="true"></div>
<div id="legalModal" role="dialog" aria-modal="true" aria-labelledby="legalTitle">
  <button id="legalClose" class="closeBtn" aria-label="Close">✕</button>

  <div id="legalContent">
    <h2 id="legalTitle">Important Disclaimer</h2>
    <p>
      The vehicle selection and road recommendations shown here are only
      <strong>general suggestions</strong> based on common road difficulty levels.
      Actual conditions can change quickly due to weather, river flow, snow, or closures.
    </p>
    <ul>
      <li>Driving on F-roads is entirely <strong>at your own risk</strong> and the driver takes full responsibility.</li>
      <li>Always check official road conditions (<em>road.is</em>) and the weather forecast before driving.</li>
      <li>Do not attempt river crossings unless you and your vehicle are fully capable.</li>
      <li>Respect road signs, closures, and your rental company’s rules.</li>
    </ul>
    <p>
      The creators of this map accept no responsibility for damages, accidents, or fines resulting from the use of these recommendations.
    </p>
  </div>

  <div id="legalFooter">
    <button id="legalAccept" type="button">I Understand</button>
  </div>
</div>


<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">


  <!-- Download GPX Button -->
  <div id="gpxDownloadBtn" class="leaflet-bar leaflet-control" style="position:absolute; top:130px; left:10px; z-index:1000;">
    <a href="#" title="Download GPX">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           stroke-width="2" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 5v14M5 12l7 7 7-7"/>
        <path d="M5 19h14" />
      </svg>
    </a>
  </div>

  
  

  <div id="exploreMapContainer"></div>

  <div id="updatesPanel" class="updates">
  <button id="closeUpdates">✕</button>
  <h2>Updates</h2>
  <ul id="updatesList" class="updates-list">
    <!-- vyplní JS -->
  </ul>
</div>

<div id="updatesBtn" class="leaflet-bar">
  <a href="#" title="View updates">
    <span class="updates-icon">!</span>
  </a>
</div>

<!-- SOS 112 button (hned pod Updates) -->
<div id="sosBtn">
  <a href="tel:112" aria-label="Call emergency number 112">112</a>
</div>



  <div id="sidePanel">
    <div id="panelHandle" aria-hidden="true"></div>
    <button id="closePanel">✕</button>
    <div id="roadStatusBadge" class="open">OPEN</div>
    <div id="roadImageWrapper" style="display:none;">
  <img id="roadImage" alt="Road Photo"/>
  <div class="high-water-badge">
  Caution: High Water Possible
</div>
  <button id="spGalleryBtn" type="button" title="Gallery">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
      <rect x="3" y="5" width="18" height="14" rx="2" fill="none" stroke="#111" stroke-width="1.6"/>
      <path d="M8 13l2-2 3 3 3-4 3 4" fill="none" stroke="#111" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
      <circle cx="8" cy="9" r="1.6" fill="#111"/>
    </svg>
    <span>Gallery</span>
  </button>

  
  
  <div id="galleryOverlay">
  <div id="galleryHeader">
    <span>Gallery</span>
    <button id="closeGallery" aria-label="Close gallery">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">
    <line x1="6" y1="6" x2="18" y2="18" stroke-width="2" stroke-linecap="round"/>
    <line x1="6" y1="18" x2="18" y2="6" stroke-width="2" stroke-linecap="round"/>
  </svg>
</button>
  </div>
  <div id="galleryStrip"></div>
</div>
</div>
    <div id="roadDetails">
      <h2>F-road Details</h2>

      <!-- Weather card -->
      <div id="wxCard" class="wx-card" title="">
  
  <!-- Teplota -->
  <div class="wx-temp">
    <div id="wxIcon" class="wx-icon" aria-hidden="true"></div>
    <div class="wx-temp-num">
      <span id="wxT">--</span><span class="unit">°C</span>
    </div>
  </div>

  <div class="wx-sep" aria-hidden="true"></div>

  <!-- Vítr -->
  <div class="wx-wind">
    <div class="wx-compass" aria-label="Wind direction">
      <svg viewBox="0 0 44 44" role="img" aria-label="Wind compass">
        <circle cx="22" cy="22" r="20" fill="#f8fafc" stroke="#dbeafe" stroke-width="1.5"/>
        <line x1="22" y1="2"  x2="22" y2="6"  stroke="#9ca3af" stroke-width="1"/>
        <line x1="22" y1="38" x2="22" y2="42" stroke="#9ca3af" stroke-width="1"/>
        <line x1="2"  y1="22" x2="6"  y2="22" stroke="#9ca3af" stroke-width="1"/>
        <line x1="38" y1="22" x2="42" y2="22" stroke="#9ca3af" stroke-width="1"/>
        <g id="wxArrow" class="arrow">
          <polygon points="22,7 18.5,17.5 25.5,17.5" fill="#e23b3b"/>
          <line x1="22" y1="17.5" x2="22" y2="31" stroke="#e23b3b" stroke-width="2" stroke-linecap="round"/>
        </g>
      </svg>
    </div>
    <div class="wx-wind-info">
      <div class="wx-wind-speed"><span id="wxF">--</span><span class="unit">m/s</span></div>
      <div class="wx-wind-dir" id="wxDtxt">--</div>
    </div>
  </div>

  <div class="wx-sep" aria-hidden="true"></div>

  <!-- Srážky -->
  <div class="wx-precip" title="Precipitation (mm/h)">
    <div class="wx-precip-icon" aria-hidden="true">
      <svg viewBox="0 0 24 24">
        <path d="M12 3C10 6 6 10 6 13.5A6 6 0 0 0 18 13.5C18 10 14 6 12 3z"
              fill="currentColor"/>
      </svg>
    </div>
    <div class="wx-precip-val">
      <span id="wxP">--</span><span class="unit">mm/h</span>
    </div>
  </div>

</div>

      
      <!-- Hidden fallback text (kept) -->
      <span id="wx" style="display:none">-- °C · -- m/s</span>

      <div>
        <strong>River Crossings:</strong>
        <span id="infoRiver"></span>
      </div>

      <strong class="info-title">Informations:</strong>

      <div class="info-row">
        <span class="info-label">Difficulty:</span>
        <span id="infoDifficulty"></span>
      </div>

      <div class="info-row">
        <span class="info-label">Length:</span>
        <span id="infoLength"></span> km
      </div>

      <div class="info-row">
        <span class="info-label">Approx. Time:</span>
        <span id="infoTime"></span>
      </div>

      <div class="info-row">
        <span class="info-label">Surface:</span>
        <span id="infoSurface"></span>
      </div>

      <div class="info-row">
        <span class="info-label">Watch out for:</span>
        <span id="infoWatch"></span>
      </div>


      <!-- River crossings section is injected below -->
    </div>
  </div>
</div>
</div>
  
<div id="chatHeader" class="chat-header" style="display:none;">
  <button id="backToGroupsBtn" class="back-btn">←</button>
  <span id="chatGroupTitle">General</span>
</div>

  <div id="chat"></div>

<!-- 🧩 Chat Group Selection -->
<div id="chatGroups" class="chat-groups">
  <h3>The Basecamp Chat</h3>
  
  <div class="chat-group" data-group="general">
  <i data-lucide="message-circle"></i>
  <span>General</span>
  <div class="desc">Casual chat and off-topic talk with other F-road travelers.</div>
  <div class="chat-avatars" id="avatars-general"></div>
</div>

<div class="chat-group" data-group="river">
  <span>River Crossing</span>
  <div class="desc">Discuss river levels, crossing safety, and share experiences.</div>
  <div class="chat-avatars" id="avatars-river"></div>
</div>

<div class="chat-group" data-group="froads">
  <span>F-Roads</span>
  <div class="desc">Updates, adventures, and stories from Iceland’s highlands.</div>
  <div class="chat-avatars" id="avatars-froads"></div>
</div>

<div class="chat-group" data-group="weather">
  <span>Weather Updates</span>
  <div class="desc">Real-time weather, storms, and wind conditions across Iceland.</div>
  <div class="chat-avatars" id="avatars-weather"></div>
</div>

<div class="chat-group" data-group="campsites">
  <span>Campsites & Spots</span>
  <div class="desc">Discover and share your favorite campsites and hidden places.</div>
  <div class="chat-avatars" id="avatars-campsites"></div>
</div>

<div class="chat-group" data-group="cars">
  <span>Cars & Gear</span>
  <div class="desc">4x4 discussions, repairs, tires, and travel gear recommendations.</div>
  <div class="chat-avatars" id="avatars-cars"></div>
</div>

<div class="chat-group" data-group="alerts">
  <span>Road Alerts & Closures</span>
  <div class="desc">F-road closures, conditions, and maintenance notifications.</div>
  <div class="chat-avatars" id="avatars-alerts"></div>
</div>

<div class="chat-group" data-group="photos">
  <span>Photo Share / Sightings</span>
  <div class="desc">Share your photos, landscapes, and wildlife moments.</div>
  <div class="chat-avatars" id="avatars-photos"></div>
</div>

<div class="chat-group" data-group="help">
  <span>Help & Rescue</span>
  <div class="desc">Emergency contacts and real-time assistance discussions.</div>
  <div class="chat-avatars" id="avatars-help"></div>
</div>

  <div class="chat-group" data-group="community">
    <span>Community & Meetups</span>
    <div class="desc">Connect with other travelers, share tips, and organize meetups.</div>
    <div class="chat-avatars" id="avatars-community"></div>
  </div>
</div>
</div>


<!-- 🖼️ Modal pro zvětšení obrázku -->
<div id="imageModal">
  <span id="closeImageModal">&times;</span>
  <img id="modalImg" src="" alt="Preview">
</div>

<div id="form" class="chat-input">
  <label for="imageUpload" class="upload-icon">
    <img src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68ebd2a7ebb8279bda871914_image.png" alt="Upload" />
  </label>
  <input type="file" id="imageUpload" accept="image/*" hidden />

  <input type="text" id="msgInput" placeholder="Write a message…" />
  <button id="sendBtn">Send</button>
</div>

<!-- 🧾 Info bar (zobrazí se po výběru fotky) -->
<div id="uploadInfo" class="upload-info">
  <span id="uploadText"></span>
  <span id="cancelUpload" class="cancel-upload">✕</span>
</div>

  <div id="profileEditor">
  <button id="closeProfileBtn" class="close-profile-btn">
  ✕
</button>
  <h3>Edit Profile</h3>

  <div class="profile-avatar">
  <div class="avatar-container">
    <img id="currentAvatar" src="https://www.gravatar.com/avatar?d=mp" alt="Avatar" />
    <button id="deleteAvatarBtn" class="avatar-delete-btn">
      <img src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68f7c2fc94b5677c444a0c31_trash.png" alt="Delete" />
    </button>
  </div>
  <label for="avatarInput" class="upload-btn">+ Upload photo</label>
  <input type="file" id="avatarInput" accept="image/*" hidden />
</div>


  <label for="displayNameInput">Name</label>
  <input type="text" id="displayNameInput" placeholder="Your name" />

  <label for="bioInput">Bio</label>
  <textarea id="bioInput" maxlength="150" placeholder="Short bio (max 150 characters)"></textarea>

  <label for="instagramInput">Instagram Handle</label>
  <input type="text" id="instagramInput" placeholder="@username" />

  <label for="vehicleSelect">Vehicle type</label>
<input type="text" id="vehicleSelect" placeholder="Enter your vehicle name" />

  <img id="vehiclePhotoPreview" src="" alt="Vehicle photo preview" style="display:none;">

<label for="vehiclePhoto" class="upload-vehicle-btn">+ Upload Vehicle Photo</label>
<input type="file" id="vehiclePhoto" accept="image/*" hidden />

  <button id="saveProfileBtn" class="btn btn-save">Save</button>
  <button id="logoutBtn" class="btn btn-logout">Logout</button>
</div>

  <div id="accessDeniedModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:10000; justify-content:center; align-items:center;">
    <div style="background:white; padding:32px; border-radius:12px; max-width:360px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.3);">
      <h2 style="margin-top:0; font-size:22px;">Access pending</h2>
      <p style="color:#555; font-size:16px; line-height:1.4;">
        <br>Your account has been created, but access is pending.<br/>
        You'll receive an email once you're approved.
      </p>
      <button onclick="closeAccessModal()" style="margin-top:20px; padding:10px 20px; background:#000; color:#fff; border:none; border-radius:8px; cursor:pointer;">
        OK
      </button>
    </div>
  </div>

  <div id="loginScreen">
    <div class="login-left"></div>
    <div class="login-right">
      <div class="login-box">
        <img id="logoImg" src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68ea50150761950e794dd2bb_logo-black.png" alt="Logo" />
        <h2 id="authTitle">Log in</h2>
        <form id="emailLoginForm" style="display: flex; flex-direction: column; gap: 14px;">
          <input type="email" id="emailInput" placeholder="Email address *" required />
          <input type="password" id="passwordInput" placeholder="Password *" required />
          <a 
  href="#" 
  id="forgotPasswordLink" 
  style="font-size:14px; color:#303030; text-decoration:underline; align-self:flex-start;"
>
  Forgot password?
</a>

          <button type="submit" class="btn login-email-btn">Log in</button>
        </form>
        <form id="signupForm" style="display: none; flex-direction: column; gap: 14px;">
          <input type="text" id="signupFullName" placeholder="Full name *" required />
          <input type="email" id="signupEmail" placeholder="Email address *" required />
          <input type="password" id="signupPassword" placeholder="Password *" required />
          <button type="submit" class="btn login-email-btn">Create account</button>
        </form>

        <p id="loginError" style="color: red; font-size: 14px; margin: 0;"></p>
        <p class="toggle-auth" id="toSignup">Don't have an account? <a href="#">Sign up</a></p>
        <p class="toggle-auth" id="toLogin" style="display: none;">Already have an account? <a href="#">Log in</a></p>

        <p class="legal-text">
          By continuing to use Froad, you agree to our
          <a href="/terms" target="_blank">Terms of Service</a> and
          <a href="/privacy" target="_blank">Privacy Policy</a>.
        </p>
      </div>
    </div>
  </div>

  <footer id="appFooter">
  <!-- Explore ikona -->
  <button class="footer-btn explore-btn" data-tab="explore">
    <img class="explore-icon" 
         src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68ed640a5b1f7f0d0f842643_map%20(3).png"
         alt="Explore" />
    <span>Explore</span>
  </button>

  <!--Community -->
  <button class="footer-btn map-btn" data-tab="map">
    <img class="map-icon"
         src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68efa731bab109784845d316_people.png"
         alt="People" />
    <span>People</span>
  </button>

  <!-- Chat -->
  <button class="footer-btn chat-btn" data-tab="chat">
    <img class="chat-icon"
         src="https://cdn.prod.website-files.com/687ebffd20183c0459d68784/68ed60dbeff425a3e7d0d35e_paper-plane.png"
         alt="Chat" />
    <span>Chat</span>
  </button>
</footer>






  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
  <script src="explore.js"></script>
  <script src="script.js"></script>
</body>
</html>
